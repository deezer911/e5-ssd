"use strict";
// Copyright (c) 2020,2021,2022, StepZen, Inc.
Object.defineProperty(exports, "__esModule", { value: true });
const debug = require("debug");
const node_fetch_1 = require("node-fetch");
const constants_1 = require("../shared/constants");
const request_1 = require("../shared/request");
exports.default = async (details, account, sdkConfig) => {
    const headers = request_1.getRequestHeaders(account, sdkConfig);
    debug('stepzen:headers')(headers);
    const response = await node_fetch_1.default(`${account.server}${constants_1.ADMIN_LIST_URL}/${details.type}`, {
        headers: headers,
        method: 'GET',
    });
    debug('stepzen:response')(response);
    if (response.status >= 400 && response.status < 500) {
        throw new Error('Could not complete the request. Please check your authentication details are correct.');
    }
    const text = await response.text();
    let json;
    try {
        json = JSON.parse(text);
    }
    catch (_a) {
        throw new Error(`An unexpected error occurred.\n\n${text}`);
    }
    return json;
};
//# sourceMappingURL=list.js.map